node {
    stage('Preparation & Checkout') {
        checkout changelog: true, poll: true, scm: [
                $class           : 'GitSCM',
                branches         : [[name: 'master']],
                extensions       : [[$class   : 'CloneOption',
                                     reference: '/home/hieule/conghm-opencps-v2-local/opencps-v2.git',
                                     shallow  : false, timeout: 75]],
                userRemoteConfigs: [[url: 'https://github.com/haminhcong/opencps-v2.git']]
        ]
    }
    stage('Update cache') {
        docker.image('gradle:4.9.0-jdk8').inside('-v gradle_cache_volume:/home/gradle/.gradle') {
                sh 'gradle -v'
                sh 'gradle --no-daemon clean --profile'
                sh 'gradle  --no-daemon --build-cache buildService'
                sh 'gradle --no-daemon  test --profile'
        }
    }
}